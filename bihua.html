<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>æ±‰å­—ç¬”é¡ºåŠ¨æ€æ¼”ç¤º</title>
	<script src="https://cdn.jsdelivr.net/npm/hanzi-writer@3.5/dist/hanzi-writer.min.js"></script>
	<style>
		body {
			font-family: "KaiTi", "æ¥·ä½“", sans-serif;
			background-color: #f4f7f6;
			display: flex;
			flex-direction: column;
			align-items: center;
			padding-top: 40px;
			margin: 0;
		}

		h2 {
			color: #333;
			margin-bottom: 20px;
		}

		/* æ§åˆ¶åŒº */
		.controls {
			margin-bottom: 30px;
			display: flex;
			gap: 10px;
			align-items: center;
		}

		input {
			padding: 10px;
			font-size: 18px;
			width: 150px;
			border: 2px solid #ddd;
			border-radius: 8px;
			text-align: center;
		}

		button {
			padding: 10px 20px;
			font-size: 16px;
			cursor: pointer;
			background-color: #ff5e5e;
			color: white;
			border: none;
			border-radius: 8px;
			transition: all 0.2s;
		}

		button:hover { background-color: #e04d4d; }
		
		button.secondary { background-color: #4CAF50; }
		button.secondary:hover { background-color: #45a049; }

		/* ç”°å­—æ ¼å®¹å™¨ */
		.grid-container {
			position: relative;
			width: 300px;
			height: 300px;
			background-color: #fff;
			box-shadow: 0 4px 15px rgba(0,0,0,0.1);
			margin-bottom: 20px;
		}

		/* ç»˜åˆ¶ç”°å­—æ ¼çº¢çº¿ (CSSå®ç°) */
		.grid-bg {
			position: absolute;
			top: 0; left: 0;
			width: 100%;
			height: 100%;
			border: 2px solid #ff5e5e;
			box-sizing: border-box;
			pointer-events: none; /* è®©ç‚¹å‡»äº‹ä»¶ç©¿é€åˆ°ä¹¦å†™å±‚ */
			z-index: 0;
		}
		
		/* æ¨ªè™šçº¿ */
		.grid-bg::before {
			content: '';
			position: absolute;
			top: 50%; left: 0;
			width: 100%; height: 1px;
			border-top: 1px dashed #ff5e5e;
		}
		
		/* ç«–è™šçº¿ */
		.grid-bg::after {
			content: '';
			position: absolute;
			left: 50%; top: 0;
			height: 100%; width: 1px;
			border-left: 1px dashed #ff5e5e;
		}

		/* æ±‰å­—ç»˜åˆ¶å±‚ */
		#character-target {
			position: relative;
			z-index: 1;
		}
		
		.status-text {
			margin-top: 10px;
			color: #666;
			font-size: 14px;
		}
	</style>
</head>
<body>

	<h2>æ±‰å­—ç¬”é¡ºæ¼”ç¤º & ç»ƒä¹ </h2>

	<div class="controls">
		<input type="text" id="charInput" value="æˆ‘" maxlength="1" placeholder="è¾“å…¥ä¸€ä¸ªå­—">
		<button onclick="updateChar()">ç”Ÿæˆ</button>
	</div>

	<div class="grid-container">
		<div class="grid-bg"></div>
		<div id="character-target"></div>
	</div>

	<div class="controls">
		<button class="secondary" onclick="animateChar()">ğŸ¥ æ¼”ç¤ºç¬”é¡º</button>
		<button class="secondary" onclick="startQuiz()">âœï¸ æˆ‘è¦ç»ƒä¹ </button>
	</div>
	
	<div id="status" class="status-text">è¾“å…¥æ±‰å­—åç‚¹å‡»â€œç”Ÿæˆâ€</div>

	<script>
		let writer = null;

		function updateChar() {
			const char = document.getElementById('charInput').value;
			const targetDiv = document.getElementById('character-target');
			const statusDiv = document.getElementById('status');

			if (!char || !/[\u4e00-\u9fa5]/.test(char)) {
				alert("è¯·è¾“å…¥ä¸€ä¸ªä¸­æ–‡å­—ç¬¦ï¼");
				return;
			}

			targetDiv.innerHTML = ''; // æ¸…ç©ºæ—§çš„å­—
			statusDiv.innerText = "åŠ è½½ä¸­...";

			// åˆå§‹åŒ– HanziWriter
			writer = HanziWriter.create('character-target', char, {
				width: 300,
				height: 300,
				padding: 20,
				showOutline: true,      // æ˜¾ç¤ºç°è‰²è½®å»“
				strokeAnimationSpeed: 1.5, // åŠ¨ç”»é€Ÿåº¦
				delayBetweenStrokes: 200, // æ¯ä¸€ç¬”ä¹‹é—´çš„åœé¡¿
				strokeColor: '#333',    // ç¬”ç”»é¢œè‰²
				radicalColor: '#333',   // éƒ¨é¦–é¢œè‰² (å¦‚éœ€åŒºåˆ†å¯æ”¹è‰²)
				outlineColor: '#ddd',   // è½®å»“é¢œè‰²
				drawingWidth: 20,       // ç¬”ç”»ç²—ç»†
				showCharacter: true     // åˆå§‹æ˜¾ç¤ºå®Œæ•´å­—
			});

			// ç›‘å¬åŠ è½½å®Œæˆ
			// HanziWriter æ˜¯å¼‚æ­¥åŠ è½½ç¬”ç”»æ•°æ®çš„
			setTimeout(() => {
				 statusDiv.innerText = `å½“å‰æ±‰å­—ï¼š${char}`;
				 // é»˜è®¤è‡ªåŠ¨æ¼”ç¤ºä¸€æ¬¡
				 writer.animateCharacter();
			}, 500);
		}

		function animateChar() {
			if (writer) {
				document.getElementById('status').innerText = "æ­£åœ¨æ¼”ç¤ºç¬”é¡º...";
				writer.animateCharacter({
					onComplete: function() {
						document.getElementById('status').innerText = "æ¼”ç¤ºç»“æŸ";
					}
				});
			}
		}

		function startQuiz() {
			if (writer) {
				document.getElementById('status').innerText = "è¯·ç”¨é¼ æ ‡/æ‰‹æŒ‡åœ¨æ ¼å­é‡Œä¹¦å†™...";
				writer.quiz({
					onMistake: function(strokeData) {
						document.getElementById('status').innerText = "å“å‘€ï¼Œç¬”é¡ºé”™å•¦ï¼è¯·é‡è¯•ã€‚";
					},
					onCorrectStroke: function(strokeData) {
						document.getElementById('status').innerText = `å¾ˆæ£’ï¼è¿™ä¸€ç¬”å†™å¯¹äº† (å‰©ä½™ ${strokeData.strokesRemaining} ç¬”)`;
					},
					onComplete: function(summaryData) {
						document.getElementById('status').innerText = `ğŸ‰ æ­å–œï¼ä½ å†™å®Œäº†ï¼`;
					}
				});
			}
		}

		// é¡µé¢åŠ è½½æ—¶é»˜è®¤åŠ è½½ä¸€ä¸ªå­—
		window.onload = updateChar;
	</script>
</body>
</html>